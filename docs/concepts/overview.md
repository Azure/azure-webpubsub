---
layout: docs
title: Overview
group: concepts
toc: true
---

## Overview

Azure Web PubSub Service provides an easy way to publish/subscribe messages using simple [WebSocket](https://tools.ietf.org/html/rfc6455) connections.
1. Simple to write a client using any language having WebSocket support
1. Both text and binary messags are supported within one connection
1. The service manages the WebSocket connections for you 
1. Provide an easy way for you to handle events such as client `connect`, `disconnect` and `send` messages.
1. Empowers you to manage the connections, such as close the connection, send to the connection, etc.

## Terms

* **Client Connection** and **ConnectionId**: A client connects to the `/client` endpoint, when connected, an unique `connectionId` is generated by the service to the client as the unique identity of the client connection. Details are described in [Client Protocol](#client_protocol) section.

* **Client Events**: Events are created during the lifecycle of a client connection. For example, a simple WebSocket client connection creates a `connect` event when it tries to connect to the service, a `send` event when it tries the send messages to the service, and a `disconnect` event when it disconnects from the service. Details about *events* are illustrated in [Client Events](#client_events) section.

* **Server**: Server is where hosts the application logic. It has the ability to handle client events, to manage client connections, to monitor group changes, and to publish messages to groups. Servers can connect to the service through `/server` endpoint using a WebSocket connection (Proactive mode), or can be a web app acts as an Upstream of the service and is invoked by the service (Passive/Webhook mode) when demanded. Details about **server** are described in [Server Protocol](#server_protocol) section.

<a name="client_protocol"></a>

## Client Protocol

A client connection can be a [simple WebSocket connection](#simple_client) to `/client` endpoint. The service also provides its own [subprotocols](https://tools.ietf.org/html/rfc6455#section-1.9) to enable WebSocket clients to do publish/subscribe directly: subprotocol [json.webpubsub.azure](#json_client) and subprotocol [protobuf.webpubsub.azure](#protobuf_client).

<a name="simple_client"></a>

### Simple WebSocket Connection
A simple WebSocket client follows a client<->server architecture, as the below sequence diagram shows:
![Simple Client Sequence](../assets/simple_client_sequence.png "Simple Client Sequence")

1. When the client starts WebSocket handshake, it triggers the `connect` event to the server to handle the handshake.
2. When the client sends messages 
#### Scenarios:
Such connection can be used in typical client-server architecture, client send messages to the server, and server handles incoming messages using [Event Handlers](#event_handlers). A typical usage would be [GraphQL Subscription](), and a sample can be found [here](). It cam also be used when customers leverages existing [subprotocols](https://www.iana.org/assignments/websocket/websocket.xml) in their application logic, for example, `wamp` subprotocol. A sample usage can be found [here]().

<a name="client_auth">

### Client Authentication

## Simple Start

## Client

Client workflow,
Client connected to service, trigger event `connect`

Connect can decide:
1. Whether or not the client is authorized
2. What `role` a client belongs to
3. 

<a name="client_events">

## Client Events

### Client Protocol

### Simple WebSocket Client

Anonymous connect:

```js

// When creating the connection, a `connect` event is generated
var client = new WebSocket("wss://xxx.webpubsub.azure.com/client");

client.onopen = e => {
    // When sending a message, a `message` event is generated    
    client.send("hello");
}

```

Authorized connect:


### WebSocket Client with `json.webpubsub.azure` subprotocol

Subscriber:

```js
var subscriber = new WebSocket("wss://xxx.webpubsub.azure.com/client", "json.webpubsub.azure");
subscriber.onmessage = e => {
    if (e.data) {
        console.log(e.data);
    }
}
```

Publisher:

```js
var publisher = new WebSocket("wss://xxx.webpubsub.azure.com/client", "json.webpubsub.azure");
publisher.onopen = e => {
    publisher.send({
        event: "publish",
        payload: "hello"
    });
}

```

### WebSocket Client with `protobuf.webpubsub.azure` subprotocol


## Client Protocol


## Server Protocol

```js

var server = new WebPubSubServer("{ConnectionString}", "publisher+subscriber+manager");
server.subscribe("group", () => {
    // callback
});
server.publish("group", "data");

server.handleEvents("connect", () => {

});
server.handleEvents("disconnect", () => {

})
server.handleEvents("publish", () => {
   // callback
}, () => {
    // filter
});

server.handleEvents("subscribe", () => {
    // callback
}, () => {
    // filter
});


var client = server.client("connectionId");
client.close();
client.send();
server.client("connectionId").close();
server.manager.sendToConnection("");


```

## Scenarios

### Client-Server Architecture

### Server-Server Pub-Sub

### Client-Client (P2P) Pub-Sub


## Events

## Authorization
### Roles
Role-Based Access Control (RBAC)

Roles:

subscriber to some group;
publish to some group;
publish to all clients;




